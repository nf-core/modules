name: "VERIFYBAMID_VERIFYBAMID2"
description: Detecting and estimating inter-sample DNA contamination became a crucial quality assessment step to ensure high quality sequence reads and reliable downstream analysis.
keywords:
  - contamination
  - bam
tools:
  - "verifybamid2":
      description: "A robust tool for DNA contamination estimation from sequence reads using ancestry-agnostic method."
      homepage: "{http://griffan.github.io/VerifyBamID}"
      documentation: "{http://griffan.github.io/VerifyBamID}"
      tool_dev_url: "{https://github.com/Griffan/VerifyBamID}"
      doi: "{https://doi.org/10.1101/gr.246934.118}"
      licence: "['MIT']"

input:
  - meta:
      type: map
      description: |
        Groovy Map containing sample information
        e.g. [ id:'test', single_end:false ]
  ## Required - min inputs
  - SVDPrefix:
      type: map
      description: |
        SVD related files prefix [Required]
        e.g parental path shared by .UD, .mu and .bed files
  - BamFile:
      type: file
      description: BAM/CRAM/SAM file
      pattern: "*.{bam,cram,sam}"
  - Reference:
      type: file
      description: reference file [Required]
      pattern: "*.fasta"
  ## Optional options
  - Seed:
      type: int
      description: Random number seed (default:12345) [Optional]
  - NumPC:
      type: int
      description: Number of Principal Components used in estimation [Optional]
  - FixPC:
      type: file
      description: Specify known PC coordinates for the sample[format PC1:PC2:PC3...] [Optional]
  - FixAlpha:
      type: real
      description: Specify known contamination level [Optional]
  - WithinAncestry:
      type: boolean
      description: Enabling withinAncestry assume target sample and contamination source are from the same populations,[default:betweenAncestry] otherwise") [Optional]
  - KnownAF:
      type: file
      description: A Bed file that provide known allele frequency for each marker, similar behaviour with VerifyBamID 1.0 [Optional]
  - Epsilon:
      type: real
      description: Minimization procedure convergence threshold, usually a trade-off bettween accuracy and running time [default:1e-10] [Optional]
  - OutputPileup:
      type: boolean
      description: If output temp pileup file [Optional]
  - Verbose:
      type: boolean
      description: If print the progress of the method [Optional]
  ## To construct SVDPrefix auxillary files
  - RefVCF:
      type: file
      description: Reference panel VCF with genotype information, for generation of .UD .mu .bed files [Optional]
  ## Pileup information related
  - no-orphans:
      type: boolean
      description: Skip anomalous read pairs in variant calling. Anomolous read pairs are those marked in the FLAG field as paired in sequencing but without the properly-paired flag set. [Optional]
  - adjust-MQ:
      type: int
      description: Coefficient for downgrading mapping quality for reads containing excessive mismatches. Given a read with a phred-scaled probability q of being generated from the mapped position, the new mapping quality is about sqrt((INT-q)/INT)*INT. A zero value disables this functionality; if enabled, the recommended value for BWA is 50. [default:40] [Optional]
  - max-depth:
      type: int
      description: Setting this limit reduces the amount of memory and time needed to process regions with very high coverage. Passing zero for this option sets it to the highest possible value, effectively removing the depth limit. [8000] [Optional]
  ## Below are deprecated but still available
  - UDPath:
      type: file
      description: .UD matrix file from SVD result of genotype matrix [Required]
  - MeanPath:
      type: file
      description: .mu matrix file of genotype matrix [Required]
  - BedPath:
      type: file
      description: .Bed file for markers used in this analysis,format(chr\tpos-1\tpos\trefAllele\taltAllele)[Required]

output:
  - meta:
      type: map
      description: |
        Groovy Map containing sample information
        e.g. [ id:'test', single_end:false ]
  - versions:
      type: file
      description: File containing software versions
      pattern: "versions.yml"
  - log:
      type: file
      description: Detailed summary of the VerifyBamId2 results
      pattern: "*.log"
  - self_SM:
      type: file
      description: Shares the same format as legacy VB1 and the key information FREEMIX indicates the estimated contamination level.
      pattern: "*.selfSM"
  - ancenstry:
      type: file
      description: PC coordinates for both intended sample and contaminating sample, with each row being one PC.
      pattern: "*.Ancestry"

authors:
  - "@manifestoso"