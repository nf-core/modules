
//include { UNTAR } from '../../../../../modules/nf-core/untar/main.nf'

nextflow_process {

    name "Test Process MTMALIGN_ALIGN"
        script "../main.nf"
        process "MTMALIGN_ALIGN"
        tag "modules"
        tag "modules_nfcore"
        tag "mtmalign"
        tag "mtmalign/align"

        test("Should run without failures") {
            setup {

                run("UNTAR") {
                    script "../../../../../modules/nf-core/untar/main.nf"
                        process {
                            """
                                input[0] = tuple([id:'test'], file("https://raw.githubusercontent.com/nf-core/test-datasets/multiplesequencealign/testdata/structures/seatoxin-ref.tar.gz", checkIfExists: true))
                                """
                        }
                }

            }

            when {
                params {
                }
                process {
                    """
                        path = UNTAR.out.untar.collect()[0]
                        print(path)
                        input[0] = tuple([id:'test'], file(path + "/*.pdb"))
                        """
                }
            }

            then {
                assert process.success
                assert snapshot(process.out).match()
            }
        }
}
