name: "gsea_gsea"
description: run the Broad Gene Set Enrichment tool in GSEA mode
keywords:
  - gene_set_analysis
  - enrichment
  - gsea
  - gene set
tools:
  - "gsea":
      description: "Gene Set Enrichment Analysis (GSEA)"
      homepage: "http://www.gsea-msigdb.org/gsea/index.jsp"
      documentation: "https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Main_Page"
      doi: "10.1073/pnas.0506580102"
      licence: "['BSD-3-clause']"

input:
  - meta:
      type: map
      description: |
        Groovy Map containing information on inputs and contrast, at a minimum
        an ID, reference and target e.g. [ id:'test', reference:"WT",
        target:"MUT" ]
  - gct:
      type: file
      description: GCT file with expression values
      pattern: "*.{gct}"
  - cls:
      type: file
      description: CL file with the classes of the samples in the GCT file
      pattern: "*.{gct}"
  - gene_sets:
      type: file
      description: GMX or GMT file with gene sets
      pattern: "*.{gmx,gmt}"
  - ext.args2:
      type: map
      description: Map provided via ext in Nextflow configuration, defining
        which of the groups defined in cls should be used for the reference and
        target groups. Can be a closure referencing the meta.

output:
  - meta:
      type: map
      description: |
        Groovy Map containing information on inputs and contrast, at a minimum
        an ID, reference and target e.g. [ id:'test', reference:"WT",
        target:"MUT" ]
  - report_tsvs:
      type: file
      description: Main TSV results report files, one for each of the pair of
        sample groups
      pattern: "gsea_report_for_*.tsv"
  - report_htmls:
      type: file
      description: Main HTML results report files, one for each of the pair of
        sample groups
      pattern: "gsea_report_for_*.html"
  - param_log:
      type: file
      description: File containing parameter settings used
      pattern: "*.rpt"
  - index:
      type: file
      description: Top level report HTML file
      pattern: "index.html"
  - heatmap:
      type: file
      description: Heat Map of the top 50 features for each phenotype in test
      pattern: "heat_map_1.png"
  - ranked_list_corr:
      type: file
      description: Ranked Gene List Correlation Profile
      pattern: "ranked_list_corr_2.png"
  - heat_map_corr_plot:
      type: file
      description: HTML file combining heatmap and rank correlation plot
      pattern: "heat_map_corr_plot.html"
  - ranked_gene_list:
      type: file
      description: TSV file with ranked gene list and scores
      pattern: "ranked_gene_list*.tsv"
  - gene_set_sizes:
      type: file
      description: TSV file with gene set sizes
      pattern: "gene_set_sizes.tsv"
  - butterfly_plot:
      type: file
      description: Butterfly plot with gene rank plotted against score
      pattern: "butterfly_plot.png"
  - histogram:
      type: file
      description: Plot showing number of gene sets by enrichment score
      pattern: "global_es_histogram.png"
  - pvalues_vs_nes_plot:
      type: file
      description: Plot showing FDR q-value by normalised enrichment score
      pattern: "pvalues_vs_nes_plot"
  - gene_set_tsv:
      type: list
      description: Where -make_sets is not set to false, TSV files, one file
        for each gene set, with detail on
        enrichment for each gene
      pattern: "[!gene_set_size|gsea_report|ranked_gene_list]*.tsv"
  - gene_set_html:
      type: list
      description: Where -make_sets is not set to false, HTML files, one file
        for each gene set, with detail on enrichment for each gene
      pattern: "[!gsea_report|heat_map_corr_plot|index|pos_snapshot|neg_snapshot]*.html"
  - gene_set_heatmap:
      type: list
      description: Where -make_sets is not set to false, PNG-format heatmaps,
        one file for each gene set, showing
        expression for each gene
      pattern: "[!butterfly|enplot|global_es_histogram|gset_rnd_es_dist|heat_map|pvalues_vs_nes_plot|ranked_list_corr]*.png"
  - gene_set_enplot:
      type: list
      description: Where -make_sets is not set to false, PNG-format enrichment
        (barcode) plots, one file for each gene set, showing how genes
        contribute to enrichment.
      pattern: "enplot*.png"
  - gene_set_dist:
      type: list
      description: Where -make_sets is not set to false, PNG-format enrichment
        score distributions plots, one file for each gene set.
      pattern: "gset_rnd_es_dist*.png"
  - snapshot:
      type: list
      description: HTML files, one each for positive and negative enrichment,
        collecting elements of gene_set_enplot
      pattern: "*_snapshot*.html"
  - archive:
      type: file
      description: Where -zip_report is set, a zip archive containing all outputs
      pattern: "*.zip"
  - versions:
      type: file
      description: File containing software versions
      pattern: "versions.yml"

authors:
  - "@pinin4fjords"
