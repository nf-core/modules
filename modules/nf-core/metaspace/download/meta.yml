# yaml-language-server: $schema=https://raw.githubusercontent.com/nf-core/modules/master/modules/meta-schema.json
name: "metaspace_download"
description: A module to download dataset results from the METASPACE platform and
  save them as CSV files, using a containerized Python script. Inputs are provided
  via a CSV file or a list of datasets, with results saved to a specified output directory.
keywords:
  - metaspace
  - metabolite annotation
  - data-download
  - csv
tools:
  - metaspace2020:
      description: Python package providing programmatic access to the METASPACE platform
      homepage: https://metaspace2020.readthedocs.io
      documentation: https://metaspace2020.readthedocs.io
      tool_dev_url: https://github.com/metaspace2020/metaspace/tree/master/metaspace/python-client
      licence: ["Apache-2.0 license"]
input:
  - - dataset_id:
        type: string
        description: |
          The ID of the dataset to process.
          The ID is the last part of the dataset URL.
          For example, in the URL `https://metaspace2020.org/dataset/2022-08-05_17h28m56s`,
          the `dataset_id` is `2022-08-05_17h28m56s`.
        optional: false
    - database:
        type: string
        description: |
          The database to download the dataset from (default: 'HMDB').
          If not provided, all dataset will be included.
        optional: true
    - version:
        type: string
        description: |
          The version of the database to download the dataset from (default: 'v4').
          If not provided, all versions will be included.
        optional: true

output:
  - results:
      - ${dataset_id}_*.csv:
          type: file
          description: |
            CSV file containing the downloaded dataset results, saved to the directory specified by the output parameter.
            Filename format is '{dataset_id}_*.csv'.
          pattern: "*.csv"
          ontologies:
            - edam: "http://edamontology.org/format_3752:latest" # CSV format
  - log:
      - "emit:":
          type: string
          description: |
            The standard output (stdout) of the script, containing log messages.
            You can print the last log to see the download progress of all the datasets.
            Example:
              METASPACE_DOWNLOAD.out.log.view { "${it.split('\n').last().trim()}" }
            It will print the last log message of the script.
            For Example:
              "❌ {dataset_id} Dataset not found or inaccessible. Skipping this dataset."
              "❌ {dataset_id} could not find database: {database}"
              "❌ {dataset_id} has no annotation data in database: {database}."
              "⚠️ {dataset_id} has multiple {database} version. All the version saved to {filename}"
              "✅ {dataset_id} with {database} database are saved to {filename}"
              "✅ {dataset_id} with all database are saved to {filename}"
  - versions:
      - versions.yml:
          type: file
          description: |
            YAML file containing the versions of the tools used in the pipeline.
            This file is automatically generated by the pipeline and should not be modified.
          pattern: "versions.yml"
          ontologies:
            - edam: "http://edamontology.org/format_3475" # YAML format
authors:
  - "@Dewey-Wang"
maintainers:
  - "@Dewey-Wang"
