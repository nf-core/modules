// TODO nf-core: Once you have added the required tests, please run the following command to build this file:
// nf-core modules test datavzrd
nextflow_process {
    name 'Test Process DATAVZRD'
    script '../main.nf'
    process 'DATAVZRD'

    tag 'modules'
    tag 'modules_nfcore'
    tag 'datavzrd'

    test('datavzrd - csv') {

        setup {
                process {
                    '''
                    input[0] = file("https://raw.githubusercontent.com/nf-core/test-datasets/modules/data/generic/csv/test.csv")
                    '''
                }
        }

        when {
            process {
                '''
                input[0] = [[id: "csv_config"], file("https://raw.githubusercontent.com/vickylaram/test-datasets/modules/data/generic/config/config_test.datavzrd.yaml", checkIfExists: true)]
                '''
            }
        }

        then {
            assertAll(
                { assert process.success },
                { assert process.out.report.isEmpty },
                { assert process.out.report.size() != 0 }
                { assert snapshot(process.out).match() }
            //TODO nf-core: Add all required assertions to verify the test output.
            // See https://nf-co.re/docs/contributing/tutorials/nf-test_assertions for more information and examples.
            )
        }
    }

    test('datavzrd - tsv') {
        setup {
                process {
                    '''
                    input[0] = file("https://raw.githubusercontent.com/nf-core/test-datasets/modules/data/generic/tsv/network.tsv", checkIfExists: true)
                    '''
                }

        }

        when {
            process {
                '''
                input[0] = [[id: "tsv_config"], file("https://raw.githubusercontent.com/vickylaram/test-datasets/modules/data/generic/config/config_network.datavzrd.yaml", checkIfExists: true)]
                '''
            }
        }

        then {
            assertAll(
                { assert process.success },
                { assert process.out.report != null },
                { assert snapshot(process.out).match() }
            //TODO nf-core: Add all required assertions to verify the test output.
            // See https://nf-co.re/docs/contributing/tutorials/nf-test_assertions for more information and examples.
            )
        }
    }

    // TODO nf-core: Change the test name preferably indicating the test-data and file-format used but keep the " - stub" suffix.
    test('datavzrd - stub') {
        options '-stub'

        when {
            process {
                '''
                input[0] = [[id: "csv_config"], file("https://raw.githubusercontent.com/vickylaram/test-datasets/modules/data/generic/config/config_test.datavzrd.yaml", checkIfExists: true)]
                '''
            }
        }

        then {
            assertAll(
                { assert process.success },
                { assert snapshot(process.out).match() }
            //TODO nf-core: Add all required assertions to verify the test output.
            )
        }
    }

    test('datavzrd - no config file') {
        when {
            process {
                '''
                input[0] = []
                '''
            }
        }

        then {
            assertAll(
                { assert process.failed },
                { assert process.out['report'].isEmpty() },
                { assert snapshot(process.out).match() }
            //TODO nf-core: Add all required assertions to verify the test output.
            // See https://nf-co.re/docs/contributing/tutorials/nf-test_assertions for more information and examples.
            )
        }
    }
}
