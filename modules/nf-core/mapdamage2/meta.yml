name: mapdamage2

description: Computational framework for tracking and quantifying DNA damage patterns among ancient DNA sequencing reads generated by Next-Generation Sequencing platforms.
keywords:
  - ancient DNA
  - DNA damage
  - NGS
  - damage patterns
  - bam
tools:
  - mapdamage2:
      description: Tracking and quantifying damage patterns in ancient DNA sequences
      homepage: http://ginolhac.github.io/mapDamage/
      documentation: https://ginolhac.github.io/mapDamage/
      tool_dev_url: https://github.com/ginolhac/mapDamage
      doi: "10.1093/bioinformatics/btt193"
      licence: ["MIT"]

input:
  - meta:
      type: map
      description: Groovy Map containing sample information e.g. [ id:'test', single_end:false ]
  - bam:
      type: file
      description: BAM file
      pattern: "*.{bam}"
  - fasta:
      type: file
      description: Fasta file, the reference the input BAM was mapped against
      pattern: "*.{fasta}"

output:
  - meta:
      type: map
      description: Groovy Map containing sample information e.g. [ id:'test', single_end:false ]
  - versions:
      type: file
      description: File containing software versions
      pattern: "versions.yml"
  - runtime_log:
      type: file
      description: Log file with a summary of command lines used and timestamps.
      pattern: "Runtime_log.txt"
  - fragmisincorporation_plot:
      type: file
      description: A pdf file that displays both fragmentation and misincorporation patterns.
      pattern: "Fragmisincorporation_plot.pdf"
  - length_plot:
      type: file
      description: A pdf file that displays length distribution of singleton reads per strand and cumulative frequencies of C->T at 5'-end and G->A at 3'-end are also displayed per strand.
      pattern: "Length_plot.pdf"
  - misincorporation:
      type: file
      description: Contains a table with occurrences for each type of mutations and relative positions from the reads ends.
      pattern: "misincorporation.txt"
  - pctot_freq:
      type: file
      description: Contains frequencies of Cytosine to Thymine mutations per position from the 5'-ends.
      pattern: "5pCtoT_freq.txt"
  - pgtoa_freq:
      type: file
      description: Contains frequencies of Guanine to Adenine mutations per position from the 3'-ends.
      pattern: "3pGtoA_freq.txt"
  - dnacomp:
      type: file
      description: Contains a table of the reference genome base composition per position, inside reads and adjacent regions.
      pattern: "dnacomp.txt"
  - lgdistribution:
      type: file
      description: Contains a table with read length distributions per strand.
      pattern: "lgdistribution.txt"
  - stats_out_mcmc_hist:
      type: file
      description: A MCMC histogram for the damage parameters and log likelihood.
      pattern: "Stats_out_MCMC_hist.pdf"
  - stats_out_mcmc_iter:
      type: file
      description: Values for the damage parameters and log likelihood in each MCMC iteration.
      pattern: "Stats_out_MCMC_iter.csv"
  - stats_out_mcmc_trace:
      type: file
      description: A MCMC trace plot for the damage parameters and log likelihood.
      pattern: "Stats_out_MCMC_trace.pdf"
  - stats_out_mcmc_iter_summ_stat:
      type: file
      description: Summary statistics for the damage parameters estimated posterior distributions.
      pattern: "Stats_out_MCMC_iter_summ_stat.csv"
  - stats_out_mcmc_post_pred:
      type: file
      description: Empirical misincorporation frequency and posterior predictive intervals from the fitted model.
      pattern: "Stats_out_MCMC_post_pred.pdf"
  - stats_out_mcmc_correct_prob:
      type: file
      description: Position specific probability of a C->T and G->A misincorporation is due to damage.
      pattern: "Stats_out_MCMC_correct_prob.csv"
  - dnacomp_genome:
      type: file
      description: Contains the global reference genome base composition (computed by seqtk).
      pattern: "dnacomp_genome.csv"
  - rescaled:
      type: file
      description: Rescaled BAM file, where likely post-mortem damaged bases have downscaled quality scores.
      pattern: "*.{bam}"
  - fasta:
      type: file
      description: Allignments in a FASTA file, only if flagged by -d.
      pattern: "*.{fasta}"
  - folder:
      type: directory
      description: Folder created when --plot-only, --rescale and --stats-only flags are passed.
      pattern: "*/"

authors:
  - "@darcy220606"
