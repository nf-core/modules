
nextflow_function {

    name "Test Functions"
    script "../main.nf"

    test("extract_references_file - without params") {

        function "extract_references_file"

        when {
            function {
                """
                input[0] = Channel.of([[
                        genome:'GRCh38_chr22',
                        id:'GRCh38_chr22',
                        species:'Homo_sapiens',
                        fasta:'\${params.igenomes_base}/test-datasets/modules/data/genomics/homo_sapiens/genome/genome.fasta',
                    ], []])
                input[1] = []
                input[2] = 'fasta'
                input[3] = 'https://raw.githubusercontent.com/nf-core/'
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }
    }

    test("extract_references_value - without params") {

        function "extract_references_value"

        when {
            function {
                """
                input[0] = Channel.of([[
                        genome:'GRCh38_chr22',
                        id:'GRCh38_chr22',
                        species:'Homo_sapiens',
                        fasta:'\${params.igenomes_base}/test-datasets/modules/data/genomics/homo_sapiens/genome/genome.fasta',
                    ], []])
                input[1] = []
                input[2] = 'species'
                """
            }
        }

        then {
            assert function.success
            assert snapshot(function.result).match()
        }
    }
}
