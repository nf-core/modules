# yaml-language-server: $schema=https://raw.githubusercontent.com/nf-core/modules/master/subworkflows/yaml-schema.json
name: "VCF_IMPUTE_MINIMAC4"
description: |
  Subworkflow to impute VCF files using MINIMAC4 software. The subworkflow
  takes VCF files, phased reference panel, and genetic maps to perform imputation
  and outputs phased and imputed VCF files.
  Meta map of all channels, except ch_input, will be used to perform joint operations.
  "regionout" key will be added to the meta map to distinguish the different file
  before ligation and therefore should not be used.
keywords:
  - VCF
  - imputation
  - minimac4
  - phasing
  - MSAV
components:
  - minimac4/compressref
  - minimac4/impute
  - bcftools/index
  - glimpse2/ligate
input:
  - ch_input:
      description: Channel with input data
      structure:
        - meta:
            type: map
            description: |
              Metadata map containing sample information
        - vcf:
            type: file
            description: Input VCF files
            pattern: "*.{vcf,bcf,vcf.gz}"
        - index:
            type: file
            description: Input index file
            pattern: "*.{tbi,csi}"
  - ch_panel:
      description: Channel with phased reference panel data
      structure:
        - meta:
            type: map
            description: |
              Metadata map that will be combined with the input data map
        - vcf:
            type: file
            description: Reference panel VCF files by chromosomes
            pattern: "*.{vcf,bcf,vcf.gz}"
        - index:
            type: file
            description: Reference panel VCF index files
            pattern: "*.{tbi,csi}"
  - ch_posfile:
      description: Channel with variants position to impute
      structure:
        - meta:
            type: map
            description: |
              Metadata map containing chromosome information
        - sites_vcf:
            type: file
            descrition: |
              VCF/BCF file containing position to impute
        - sites_index:
            type: file
            description: |
              CSI|TBI index file of the sites to impute
  - ch_chunks:
      description: Channel containing the region to impute
      structure:
        - meta:
            type: map
            description: |
              Metadata map containing chromosome information
        - regionout:
          type: string
          description: Region to perform the phasing on
          pattern: "[chr]+[0-9]+:[0-9]+-[0-9]+"
  - ch_map:
      description: Channel with genetic map data
      structure:
        - meta:
            type: map
            description: |
              Metadata map containing chromosome information
        - map:
            type: file
            description: Minimac format genetic map files
            pattern: "*.map"
output:
  - vcf_index:
      description: Channel with imputed and phased VCF files
      structure:
        - meta:
            type: map
            description: |
              Metadata map of the target input file combined with the reference panel map.
        - vcf:
            type: file
            description: VCF imputed and phased file by sample
            pattern: "*.{vcf,bcf,vcf.gz}"
        - index:
            type: file
            description: VCF index file
            pattern: "*.{tbi,csi}"
authors:
  - "@LouisLeNezet"
  - "@gichas"
maintainers:
  - "@LouisLeNezet"
  - "@gichas"
